server {
  listen 80;
  server_name _;

  # 静的ファイル
  root /usr/share/nginx/html;
  index index.html;

  # / で index.html を配信
  location = / {
    try_files /index.html =404;
  }

  # アプリのヘルス
  location /health {
    proxy_pass http://app:8010/health;
    include /etc/nginx/proxy_params;
  }

  # API → app へプロキシ
  location /ask {
    proxy_pass http://app:8010/ask;
    include /etc/nginx/proxy_params;
  }
  location /feedback {
    proxy_pass http://app:8010/feedback;
    include /etc/nginx/proxy_params;
  }
  location /admin {
    proxy_pass http://app:8010/admin;
    include /etc/nginx/proxy_params;
  }

  # セキュリティ系ヘッダ（必要に応じて）
  add_header X-Content-Type-Options "nosniff" always;
  add_header X-Frame-Options "SAMEORIGIN" always;
  add_header Referrer-Policy "no-referrer-when-downgrade" always;
  add_header Content-Security-Policy "default-src 'self'; frame-ancestors 'self';" always;
}
